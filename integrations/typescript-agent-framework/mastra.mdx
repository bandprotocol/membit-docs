---
title: "Mastra"
description: "Integrate Membit's real-time social context into your Mastra agents using MCP tools."
icon: "mastra"
---

Enhance your Mastra applications with real-time social media context from Membit. This integration allows your AI agents to access up-to-the-minute discussions, trends, and insights from platforms like X (Twitter), Farcaster, and more.

## Prerequisites

Before you begin, ensure you have:

- Node.js 20 or higher installed
- A Membit account with API access
- Basic familiarity with Mastra agents
- TypeScript knowledge (recommended)

<Warning>
You'll need valid Membit API credentials and the MCP remote URL. If you don't have access yet, [get your API key](/access-and-auth) to get started.
</Warning>

## Installation

Install the required packages for Mastra and MCP integration:

```bash
# Install Mastra with MCP support
npm install @mastra/mcp@latest

# Install MCP remote client
npm install -g mcp-remote
```

<Tip>
Mastra works best with TypeScript. Make sure your project is configured for TypeScript development.
</Tip>

## Quick Start

<Steps>
<Step title="Import required modules">
Import the necessary components for Mastra and MCP integration:

```typescript
import { openai } from "@ai-sdk/openai";
import { Agent } from '@mastra/core/agent';
import { LibSQLStore } from '@mastra/libsql';
import { MCPClient } from "@mastra/mcp";
```
</Step>

<Step title="Initialize MCP client">
Create an MCP client to connect to Membit's tools:

```typescript
export const mcp = new MCPClient({
  servers: {
    membit: {
      command: "npx",
      env: {
        API_KEY: <your-api-key>,
      },
      args: [
        "mcp-remote",
        "https://mcp.membit.ai/mcp",
        "--header",
        "X-Membit-Api-Key:${API_KEY}",
      ],
    },
  },
});
```

<Note>
Make sure you have `mcp-remote` installed globally via npm for this to work.
</Note>

<Warning>
Replace `<your-api-key>` with your actual Membit API key. Keep this credential secure and don't share it with unauthorized users.
</Warning>
</Step>

<Step title="Create your Membit-powered agent">
Create a Mastra agent with Membit tools and memory:

```typescript
export const membitAgent = new Agent({
  name: 'Social Media Analyst',
  instructions: `You are a social media analyst with access to real-time data. Use cluster_search to find trending discussions, cluster_info for detailed analysis, and post_search for specific posts.`,
  model: openai("gpt-4o-mini"),
  tools: await mcp.getTools(),
});
```
</Step>

<Step title="Use your agent">
Execute your agent with social media analysis tasks:

```typescript
const result = await membitAgent.generate(
  "What are the most trending discussions about AI today? Use cluster_search to find hot topics and provide insights with URLs."
);

console.log(result.text);
```

<Check>
Your Mastra agent is now powered by real-time social media context from Membit!
</Check>
</Step>
</Steps>

## Complete Example

Here's a full working example that demonstrates the integration:

<CodeGroup>
```typescript Basic Integration
import { openai } from "@ai-sdk/openai";
import { Agent } from '@mastra/core/agent';
import { LibSQLStore } from '@mastra/libsql';
import { MCPClient } from "@mastra/mcp";

// Initialize MCP client for Membit
export const mcp = new MCPClient({
  servers: {
    membit: {
      command: "npx",
      env: {
        // Replace `<your-api-key>` with your actual Membit API key.
        API_KEY: <your-api-key>,
      },
      args: [
        "mcp-remote",
        "https://mcp.membit.ai/mcp",
        "--header",
        "X-Membit-Api-Key:${API_KEY}",
      ],
    },
  },
});

// Create Membit-powered agent
export const membitAgent = new Agent({
  name: 'Membit Social Analyst',
  instructions: `You are an expert social media analyst with access to real-time trending data. 
  Use cluster_search to find trending discussions, cluster_info to dive deeper into specific conversations, 
  and post_search to find individual posts. Always provide context and source URLs.`,
  model: openrouter("anthropic/claude-3-5-sonnet-20241022"),
  tools: await mcp.getTools(),
});

async function main() {
  try {
    const result = await membitAgent.generate(
      "What are the most trending discussions today related to Bitcoin? Use cluster_search to find hot topics and provide the best conversations to follow with URLs."
    );
    
    console.log("Analysis Results:");
    console.log(result.text);
  } catch (error) {
    console.error("Error during analysis:", error);
  }
}

main();
```
</CodeGroup>

## Best Practices

<Card title="Agent Instructions" icon="message">
- Write clear, specific instructions that guide agents to use appropriate Membit tools
- Specify which tool to use for different types of analysis
- Include instructions about source attribution and URL inclusion
</Card>

<Card title="Memory Management" icon="database">
- Use LibSQLStore for persistent memory across agent sessions
- Create separate databases for different agent specializations
- Store conversation context to improve analysis over time
</Card>

<Card title="MCP Client Configuration" icon="network-wired">
- Use environment variables for MCP URLs and API keys
- Handle connection failures gracefully in production
- Verify tool availability after MCP client initialization
</Card>

## Troubleshooting

<AccordionGroup>
<Accordion title="MCP Connection Issues">
**Problem**: Cannot connect to Membit MCP server

**Solutions**:
- Verify `mcp-remote` is installed: `npm list -g mcp-remote`
- Check your API key
- Ensure Node.js is properly installed and accessible
- Test connectivity with `npx mcp-remote` directly
</Accordion>

<Accordion title="Tool Loading Failures">
**Problem**: `mcp.getTools()` returns empty or fails

**Solutions**:
- Ensure MCP client is properly configured with correct server parameters
- Check network connectivity and firewall settings
- Verify your Membit API credentials are valid
- Try initializing the MCP client in a try-catch block
</Accordion>

<Accordion title="Agent Generation Issues">
**Problem**: Agents don't use Membit tools effectively

**Solutions**:
- Make agent instructions more explicit about tool usage
- Test with simpler, more direct queries first
- Check that tools are properly loaded: `console.log(await mcp.getTools())`
- Verify the agent's memory storage is accessible
</Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={2}>
<Card title="Explore Use Cases" icon="compass" href="/use-cases">
  Discover practical applications for Membit in different industries and scenarios.
</Card>

<Card title="API Reference" icon="code" href="/api-usage/typescript">
  Dive deeper into Membit's TypeScript API for custom implementations.
</Card>

<Card title="Get Support" icon="life-ring" href="/misc/faqs">
  Find answers to common questions or reach out for help.
</Card>
</CardGroup>
